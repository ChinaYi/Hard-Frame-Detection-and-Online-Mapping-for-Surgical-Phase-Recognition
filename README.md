# Hard-Frame-Detection-and-Online-Mapping-for-Surgical-Phase-Recognition
The Code for M2CAI19 Paper: Hard Frame Detection and Online Mapping for Surgical Phase Recognition.


## Requirement
Pytorch version >= 0.4
python version >= 3.0
GPU Memory >= 9000mb

## Download the Dataset
We downsample the videos at 5fps. We recommand you download the dataset with this link: 
https://mega.nz/#!rEN2FCwB!VEChVilyX2yGpge_pjfjNuu8qH6qeFX6q5b8_v_ydVw
https://mega.nz/#!zqZkGaBT!P5hhMe_BuyM3RQPRu0jdJR-x3EEmcB0cAe0BOxw5-_U


## DataCleaning
The folder 'DataCleaning' contains the code for data cleansing step. This step is time-costing, so, we suggest to use the data cleansing results that are contained in the link we provided.

## OHFM
The folder 'OHFM' contains the code for OHFM.

utils_2.py: Code for drawing segment bars.
